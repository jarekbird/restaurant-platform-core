# TASK-009: Implement SEO Metadata Generator

**Section**: 3. SEO Metadata & On-Page Structure
**Subsection**: 3.1
**Task ID**: TASK-009

## Description

Implement a function that generates SEO metadata (title, description, Open Graph, Twitter cards) for all page types. The metadata follows Owner.com patterns: combining restaurant name, cuisine, and city in titles, and creating benefit-driven descriptions.

This supports SEO and social sharing by providing properly formatted metadata for search engines and social platforms.

**Reference Implementation**: 
- `menuhq/restaurant-finder/plan/phase-3/master-plan.md` (Section 4.2)

## Current State

- Restaurant models exist (from TASK-002)
- URL builders exist (from TASK-007)
- SEOMetadata model exists in configs (from TASK-003)
- No metadata generator exists

**Prerequisites**: TASK-002, TASK-003, TASK-007 must be completed

## Checklist

### Preparation and Setup

- [ ] Review master plan Section 4.2 for metadata templates
- [ ] Review SEOMetadata model from TASK-003
- [ ] Understand Owner.com title/description patterns
- [ ] Plan metadata templates for each page type

### Implementation Steps

- [ ] Step 1: Create SEO generator module
  - [ ] Create `src/restaurant_site_planner/generators/` directory
  - [ ] Create `src/restaurant_site_planner/generators/__init__.py`
  - [ ] Create `src/restaurant_site_planner/generators/seo.py`
- [ ] Step 2: Implement base metadata generator
  - [ ] Add `build_seo_metadata(page_type: str, restaurant: Optional[Restaurant], location: Optional[Location] = None, city: Optional[str] = None, cuisine: Optional[str] = None) -> SEOMetadata` function
  - [ ] Support page types: "home", "menu", "catering", "location", "city_index", "cuisine_index", "promo", "news"
  - [ ] Return SEOMetadata object with all fields populated
- [ ] Step 3: Implement restaurant home metadata
  - [ ] Title template: `[{Restaurant Name}] | [Cuisine] in [City, State] | Order Online`
  - [ ] Description: Short, benefit-driven summary including cuisine, neighborhood, primary action
  - [ ] Use restaurant data: name, cuisine, city, state, neighborhood
  - [ ] Include primary CTA in description (Order Online)
- [ ] Step 4: Implement menu page metadata
  - [ ] Title template: `[Restaurant Name] Menu | Order [Cuisine] Online in [City]`
  - [ ] Description: Mention online ordering, pickup/delivery, special dishes
  - [ ] Include menu highlights if available
- [ ] Step 5: Implement catering page metadata
  - [ ] Title template: `[Restaurant Name] Catering | [Cuisine] Catering in [City]`
  - [ ] Description: Focus on catering services, group orders
- [ ] Step 6: Implement city index metadata
  - [ ] Title template: `Best Restaurants in [City] | [City] Dining Guide`
  - [ ] Description: Overview of restaurants in city, encourage exploration
- [ ] Step 7: Implement cuisine index metadata
  - [ ] Title template: `Best [Cuisine] in [City] | [City] [Cuisine] Restaurants`
  - [ ] Description: Focus on cuisine type, mention top restaurants
- [ ] Step 8: Implement Open Graph fields
  - [ ] `og_title`: Same as title or slightly modified for social
  - [ ] `og_description`: Same as description or social-optimized version
  - [ ] `og_image`: Hero image URL or restaurant logo
  - [ ] `og_type`: "website" for most pages
  - [ ] `og_locale`: Based on location (e.g. "en_US")
  - [ ] `og_url`: Canonical URL for the page
- [ ] Step 9: Implement Twitter card fields
  - [ ] `twitter_card`: "summary_large_image" or "summary"
  - [ ] `twitter_title`: Same as og_title
  - [ ] `twitter_description`: Same as og_description
  - [ ] `twitter_image`: Same as og_image

### Specific Requirements

- [ ] Requirement 1: Titles follow Owner.com patterns
  - [ ] Restaurant name, cuisine, city are included
  - [ ] Primary action is mentioned (Order Online)
  - [ ] Titles are concise (under 60 characters ideally)
- [ ] Requirement 2: Descriptions are benefit-driven
  - [ ] Include what they serve, who they serve, where
  - [ ] Include primary action (order, visit, etc.)
  - [ ] Descriptions are 150-160 characters for optimal display
- [ ] Requirement 3: OG/Twitter fields are consistent
  - [ ] OG and Twitter fields match base metadata
  - [ ] Images are provided when available
  - [ ] URLs are absolute and canonical

### Error Handling and Edge Cases

- [ ] Handle error case 1: Missing restaurant data
  - [ ] Use defaults or skip restaurant-specific fields
  - [ ] City index doesn't require restaurant
- [ ] Handle error case 2: Missing city/state
  - [ ] Use city only if state not available
  - [ ] Handle gracefully
- [ ] Handle edge case 1: Very long restaurant names
  - [ ] Truncate titles if needed (preserve important info)
- [ ] Handle edge case 2: Missing images
  - [ ] Use restaurant logo or placeholder
  - [ ] OG image is optional but recommended

### Testing

- [ ] Write unit tests: `tests/test_generators_seo.py`
  - [ ] Test `build_seo_metadata()` for restaurant home page
  - [ ] Test `build_seo_metadata()` for menu page
  - [ ] Test `build_seo_metadata()` for catering page
  - [ ] Test `build_seo_metadata()` for city index page
  - [ ] Test `build_seo_metadata()` for cuisine index page
  - [ ] Test exact expected title for sample restaurants
  - [ ] Test exact expected description for sample restaurants
  - [ ] Test OG fields are consistent with base metadata
  - [ ] Test Twitter fields are consistent with base metadata
  - [ ] Test metadata includes restaurant name, cuisine, city
  - [ ] Test metadata handles missing optional fields
- [ ] Run full test suite: `pytest tests/test_generators_seo.py`
- [ ] Verify test coverage: `pytest --cov=restaurant_site_planner.generators.seo`

### Documentation

- [ ] Add docstrings to SEO generator function
- [ ] Document title/description templates
- [ ] Add examples of generated metadata

### Verification

- [ ] Verify metadata follows Owner.com patterns
- [ ] Verify OG/Twitter fields are populated
- [ ] Verify no regressions

## Notes

- This task is part of Phase 3: Owner.com-Aligned Restaurant Sites
- **Execution Timing**: After TASK-007, before TASK-010
- **Dependencies**: 
  - TASK-002: Restaurant models
  - TASK-003: SEOMetadata model
  - TASK-007: URL builders
- **Important Considerations**: 
  - Titles should be optimized for search and social
  - Descriptions should encourage clicks
  - Keep metadata concise but informative
- **Task Independence**: Can be developed after dependencies

## Related Tasks

- Previous: TASK-008 (Internal linking)
- Next: TASK-010 (Heading structure)
- Dependencies:
  - TASK-002, TASK-003, TASK-007
- Related:
  - TASK-015: Will use SEO metadata in page configs

## Definition of Done

### Task Type: CODE/FILE WRITING TASK

**User Stories**:
1. **As an SEO specialist**, I want properly formatted metadata so search engines can index pages correctly
2. **As a developer**, I want metadata generators so I can create SEO-friendly pages automatically
3. **As a marketer**, I want social-optimized metadata so pages share well on social platforms

**Automated Tests**:
- [ ] Unit tests exist: `tests/test_generators_seo.py`
- [ ] All tests pass: `pytest tests/test_generators_seo.py` exits with code 0
- [ ] Tests verify exact expected title and description for sample restaurants and page types
- [ ] Tests verify OG/Twitter fields are consistent with base metadata
- [ ] Test coverage >= 85%

**Code Quality**:
- [ ] Function has type hints
- [ ] Metadata templates are clear and maintainable
- [ ] Code follows Python style guidelines

**Git & Version Control**:
- [ ] All new files are added to git: `git add .`
- [ ] Changes are committed: `git commit -m "TASK-009: Implement SEO metadata generator"`
- [ ] Code is pushed to origin: `git push origin <branch-name>`
- [ ] Commit message includes task ID: TASK-009

**Final Verification**:
- [ ] All checklist items completed
- [ ] All tests pass
- [ ] Metadata follows Owner.com patterns
- [ ] Code committed and pushed
