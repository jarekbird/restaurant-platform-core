# TASK-1.3: Extend Theme type and theme utilities

**Section**: 1. Theme System & Owner-Style Theme Variants
**Subsection**: 1.3
**Task ID**: TASK-1.3

## Description

Extend the existing `Theme` type in `lib/themes/index.ts` to ensure it fully supports Owner.com-aligned design tokens. Add/verify fields for comprehensive color tokens, typography tokens, and optional shape/spacing tokens. Keep the API compatible with `RestaurantThemeProvider` and `useTheme()` hook. This task focuses on extending the type definition and ensuring all required tokens are present, without yet creating new theme variants.

**Reference Implementation**: 
- `lib/themes/index.ts` (current Theme interface)
- `components/theme/ThemeProvider.tsx` (how Theme is used)
- `components/restaurant/HeroSection.tsx` (example usage of useTheme)

## Current State

The current `Theme` interface in `lib/themes/index.ts` has:
- Basic color tokens: `primary`, `secondary`, `background`, `surface`, `text`, `textMuted`, `border`
- Basic typography tokens: `heading`, `body`
- A `themes` record with 3 existing themes: `sushi-dark`, `cafe-warm`, `pizza-bright`
- A `getTheme(themeKey)` function that returns a Theme with fallback

The interface may be missing:
- An `accent` color token (for secondary emphasis)
- Optional shape tokens (e.g., `radii.card`, `radii.button`)
- Optional spacing tokens (if needed beyond Tailwind defaults)
- More comprehensive typography tokens (font families, weights, sizes)

**Important**: This task should be executed after TASK-0.2, and before TASK-1.4 (defining new theme variants).

## Checklist

### Preparation and Setup

- [ ] Review `lib/themes/index.ts` to understand current Theme structure
- [ ] Review `master-plan-redacted.md` Section 3.1 for required tokens
- [ ] Review `owner-com-research.md` for Owner.com design token patterns
- [ ] Review how `useTheme()` is used in existing components (HeroSection, etc.)
- [ ] Understand Tailwind CSS class structure to ensure tokens are compatible

### Implementation Steps

- [ ] Step 1: Extend Theme interface
  - [ ] Add `accent` color token to `colors` object
  - [ ] Verify all required color tokens are present: `background`, `surface`, `primary`, `accent`, `text`, `textMuted`, `border`
  - [ ] Add optional `radii` object with `card`, `button`, `badge` properties (if needed)
  - [ ] Extend typography to include font families, weights, sizes (if needed beyond current `heading`/`body`)
- [ ] Step 2: Update existing themes to include new tokens
  - [ ] Update `sushi-dark` theme to include `accent` color
  - [ ] Update `cafe-warm` theme to include `accent` color
  - [ ] Update `pizza-bright` theme to include `accent` color
  - [ ] Add optional `radii` values to existing themes (if added to interface)
- [ ] Step 3: Ensure backward compatibility
  - [ ] Verify `getTheme()` still works with existing theme keys
  - [ ] Verify `useTheme()` hook still works in existing components
  - [ ] Test that existing components don't break with extended Theme

### Specific Requirements

- [ ] Requirement 1: Theme interface must include all required color tokens:
  - `background`: page/hero background
  - `surface`: card backgrounds
  - `primary`: main CTA/button background
  - `accent`: secondary emphasis (NEW)
  - `text`: headings text color
  - `textMuted`: body/supporting text color
  - `border`: section & card borders
- [ ] Requirement 2: Typography tokens must include at least:
  - `heading`: heading font/style classes
  - `body`: body font/style classes
  - Optionally: font families, weights, sizes if needed
- [ ] Requirement 3: Optional shape tokens (if added):
  - `radii.card`: border radius for cards
  - `radii.button`: border radius for buttons
  - `radii.badge`: border radius for badges
- [ ] Requirement 4: All existing themes must be updated to include new required tokens
- [ ] Requirement 5: API must remain compatible with `RestaurantThemeProvider` and `useTheme()`

### Error Handling and Edge Cases

- [ ] Handle case where `getTheme()` receives an invalid themeKey (fallback to default)
- [ ] Ensure TypeScript types are strict (no `any` types)
- [ ] Handle optional tokens gracefully (use defaults if not provided)

### Testing

- [ ] Write unit tests for `getTheme(themeKey)`:
  - [ ] Test that it returns a complete Theme object for known keys (`sushi-dark`, `cafe-warm`, `pizza-bright`)
  - [ ] Test that it returns default theme for unknown keys
  - [ ] Test that returned Theme has all required color tokens
  - [ ] Test that returned Theme has all required typography tokens
- [ ] Write snapshot tests for a sample theme to guard against accidental token removal
- [ ] Write component tests that render components using `useTheme()` and verify theme tokens are accessible
- [ ] Run full test suite: `npm test` (if applicable)
- [ ] Run type checking: `npm run type-check` (if applicable)
- [ ] Run linting: `npm run lint` (if applicable)
- [ ] **DO NOT manually test by running the server** - use automated tests instead

### Documentation

- [ ] Update JSDoc/TSDoc comments on Theme interface
- [ ] Document new `accent` color token purpose
- [ ] Document optional `radii` tokens (if added)
- [ ] Update any theme-related documentation

### Verification

- [ ] Verify Theme interface includes all required tokens
- [ ] Verify all existing themes are updated with new tokens
- [ ] Verify backward compatibility (existing components still work)
- [ ] Verify TypeScript types are correct (no errors)
- [ ] Verify all tests pass
- [ ] Verify code quality standards are met

## Notes

- This task is part of Phase 3: Theme System & Owner-Style Theme Variants
- **Execution Timing**: Execute after TASK-0.2, before TASK-1.4
- **Dependencies**: 
  - TASK-0.1: Review current preview architecture
  - TASK-0.2: Confirm prototype-only constraints
- **Important Considerations**: 
  - Must maintain backward compatibility with existing components
  - Tokens should be Tailwind CSS class strings (e.g., `'bg-red-600 text-white'`)
  - Optional tokens should have sensible defaults or be omitted if not needed
- **Task Independence**: Can be completed independently after dependencies
- **Current State**: Theme interface exists but may be missing some Owner.com-aligned tokens

## Related Tasks

- Previous: TASK-0.2 (Confirm prototype-only constraints)
- Next: TASK-1.4 (Define Owner-inspired theme variants)
- Dependencies:
  - TASK-0.1: Review current preview architecture
  - TASK-0.2: Confirm prototype-only constraints
- Related:
  - TASK-1.4: Will use the extended Theme interface to create new theme variants
  - TASK-1.5: Will wire themes through components using the extended tokens

## Definition of Done

This is a **CODE/FILE WRITING TASK**.

**Definition of Done**: "The Theme interface has been extended with all required Owner.com-aligned tokens (including `accent` color and optional shape tokens). All existing themes have been updated to include new tokens. Unit tests verify `getTheme()` returns complete Theme objects. Snapshot tests guard against token removal. Component tests verify `useTheme()` works correctly. All tests pass. Code is committed and pushed to origin."

**User Stories**:
- As a developer, I want a comprehensive Theme interface with all Owner.com-aligned tokens so I can create consistent, conversion-optimized designs
- As a developer, I want an `accent` color token so I can add secondary emphasis elements
- As a developer, I want optional shape tokens so I can control border radii consistently
- As a component, I want to access theme tokens via `useTheme()` without breaking changes

**Automated Tests**: 
- Unit tests for `getTheme(themeKey)` returning complete Theme objects for known keys
- Unit tests for `getTheme(themeKey)` returning default theme for unknown keys
- Unit tests verifying all required color and typography tokens are present
- Snapshot tests for a sample theme to guard against accidental token removal
- Component tests rendering components with `useTheme()` and verifying tokens are accessible

**Git Commit & Push**: 
- Commit with message: `feat(phase-3): extend Theme interface with Owner.com-aligned tokens (TASK-1.3)`
- Push to origin: `git push origin <branch-name>`
- Ensure all test files are included in the commit
