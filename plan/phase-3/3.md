# TASK-003: Define Output Contract Models for Website Configuration

**Section**: 0. Project Scaffolding & Foundations
**Subsection**: 0.3
**Task ID**: TASK-003

## Description

Create Python models that represent the output website configurations. These models define the structure of the JSON configurations that will be consumed by the front-end to render Owner.com-aligned restaurant websites.

The models include a generic `PageConfig` template and specialized configs for different page types (home, menu, location, city index, etc.). These configs will include SEO metadata, hero sections, content sections, and structured data (JSON-LD).

**Reference Implementation**: `menuhq/restaurant-finder/plan/phase-3/master-plan.md` (Sections 2, 3, 4)

## Current State

- Input models exist (from TASK-002)
- No output configuration models exist yet
- Need to define the contract between Python planner and front-end consumer
- Theme model will be defined here (detailed implementation in TASK-004)

**Prerequisites**: TASK-001 and TASK-002 must be completed

## Checklist

### Preparation and Setup

- [ ] Review master plan sections 2, 3, 4 for configuration requirements
- [ ] Review Owner.com research document for design patterns
- [ ] Understand what data the front-end will need to render pages
- [ ] Plan model hierarchy (base PageConfig vs. specialized configs)

### Implementation Steps

- [ ] Step 1: Create config models module
  - [ ] Create `src/restaurant_site_planner/configs/` directory
  - [ ] Create `src/restaurant_site_planner/configs/__init__.py`
  - [ ] Create `src/restaurant_site_planner/configs/base.py` (PageConfig)
  - [ ] Create `src/restaurant_site_planner/configs/theme.py` (RestaurantTheme stub - detailed in TASK-004)
  - [ ] Create `src/restaurant_site_planner/configs/pages.py` (specialized configs)
- [ ] Step 2: Implement base PageConfig model
  - [ ] Define `PageConfig` base class with:
    - [ ] `path: str` (required) - URL path for the page
    - [ ] `seo: SEOMetadata` (required) - SEO title, description, OG tags
    - [ ] `hero: Optional[HeroSection]` - Hero section config
    - [ ] `sections: List[PageSection]` (required, at least one) - Content sections
    - [ ] `schema_json_ld: Optional[Dict]` - Structured data
    - [ ] `breadcrumbs: Optional[List[Breadcrumb]]` - Navigation breadcrumbs
  - [ ] Add validation: at least one section required
- [ ] Step 3: Implement supporting models
  - [ ] Define `SEOMetadata` with:
    - [ ] `title: str` (required)
    - [ ] `description: str` (required)
    - [ ] `og_title: Optional[str]`
    - [ ] `og_description: Optional[str]`
    - [ ] `og_image: Optional[str]`
    - [ ] `og_type: str` (default "website")
    - [ ] `twitter_card: Optional[str]`
    - [ ] `canonical_url: Optional[str]`
  - [ ] Define `HeroSection` with:
    - [ ] `headline: str` (required)
    - [ ] `subheadline: Optional[str]`
    - [ ] `image_url: Optional[str]`
    - [ ] `primary_cta: CTAAction` (required)
    - [ ] `secondary_cta: Optional[CTAAction]`
    - [ ] `layout: str` (image-left, image-right, full-bleed)
  - [ ] Define `CTAAction` with:
    - [ ] `text: str` (required)
    - [ ] `url: str` (required)
    - [ ] `type: str` (order, menu, call, directions, etc.)
  - [ ] Define `PageSection` base class (abstract/polymorphic)
  - [ ] Define `Breadcrumb` with:
    - [ ] `label: str` (required)
    - [ ] `url: str` (required)
- [ ] Step 4: Implement specialized page configs
  - [ ] Define `RestaurantHomeConfig(PageConfig)` with:
    - [ ] All PageConfig fields
    - [ ] Restaurant-specific sections: menu highlights, about, reviews, location
  - [ ] Define `MenuPageConfig(PageConfig)` with:
    - [ ] Menu-specific sections: category sections with items
  - [ ] Define `LocationPageConfig(PageConfig)` with:
    - [ ] Location-specific data: address, map, hours
  - [ ] Define `CityIndexPageConfig(PageConfig)` with:
    - [ ] List of restaurants in city
  - [ ] Define `CuisineIndexPageConfig(PageConfig)` with:
    - [ ] List of restaurants for cuisine in city
  - [ ] Define `PromoPageConfig(PageConfig)` with:
    - [ ] Campaign/promo specific content
  - [ ] Define `NewsPostConfig(PageConfig)` with:
    - [ ] Blog/news post content
- [ ] Step 5: Implement RestaurantTheme stub (detailed in TASK-004)
  - [ ] Define `RestaurantTheme` class structure (fields will be detailed in TASK-004)
  - [ ] Placeholder for color, typography, spacing, shape, shadow, layout tokens

### Specific Requirements

- [ ] Requirement 1: All configs serialize to JSON cleanly
  - [ ] `.model_dump_json()` produces valid JSON
  - [ ] No circular references
  - [ ] Datetime objects serialize correctly
- [ ] Requirement 2: Required fields are enforced
  - [ ] Every page has `path` and `seo`
  - [ ] Every page has at least one section
  - [ ] Validation errors are clear
- [ ] Requirement 3: Configs are extensible
  - [ ] Easy to add new section types
  - [ ] Easy to add new page config types
  - [ ] Backward compatible with optional fields

### Error Handling and Edge Cases

- [ ] Handle error case 1: Missing required fields
  - [ ] Clear validation error messages
  - [ ] Field path in error message
- [ ] Handle error case 2: Invalid section types
  - [ ] Unknown section type raises error or is ignored with warning
- [ ] Handle edge case 1: Empty sections list
  - [ ] Validation requires at least one section
- [ ] Handle edge case 2: Invalid URLs in CTAs
  - [ ] URL validation or warning

### Testing

- [ ] Write unit tests: `tests/test_configs_base.py`
  - [ ] Test PageConfig creation with all fields
  - [ ] Test PageConfig with minimal required fields
  - [ ] Test validation error for missing path
  - [ ] Test validation error for missing seo
  - [ ] Test validation error for empty sections
  - [ ] Test serialization to JSON
  - [ ] Test deserialization from JSON
- [ ] Write unit tests: `tests/test_configs_pages.py`
  - [ ] Test RestaurantHomeConfig creation
  - [ ] Test MenuPageConfig creation
  - [ ] Test LocationPageConfig creation
  - [ ] Test CityIndexPageConfig creation
  - [ ] Test CuisineIndexPageConfig creation
  - [ ] Test PromoPageConfig creation
  - [ ] Test NewsPostConfig creation
- [ ] Write unit tests: `tests/test_configs_serialization.py`
  - [ ] Test all configs serialize to valid JSON
  - [ ] Test round-trip: Config -> JSON -> Config (data preservation)
  - [ ] Test JSON is human-readable (proper indentation)
- [ ] Run full test suite: `pytest`
- [ ] Verify test coverage: `pytest --cov=restaurant_site_planner.configs`

### Documentation

- [ ] Add docstrings to all config classes
- [ ] Document config structure in README
- [ ] Add examples of each config type
- [ ] Document how front-end should consume these configs

### Verification

- [ ] Verify all configs can be created
- [ ] Verify serialization works
- [ ] Verify validation works
- [ ] Verify no regressions

## Notes

- This task is part of Phase 3: Owner.com-Aligned Restaurant Sites
- **Execution Timing**: After TASK-002, before TASK-004
- **Dependencies**: 
  - TASK-001: Package structure
  - TASK-002: Input models
- **Important Considerations**: 
  - RestaurantTheme is a stub here - full implementation in TASK-004
  - Configs should be JSON-serializable for front-end consumption
  - Keep configs aligned with Owner.com patterns from master plan
- **Task Independence**: Can be developed after TASK-002

## Related Tasks

- Previous: TASK-002 (Input models)
- Next: TASK-004 (RestaurantTheme implementation)
- Dependencies:
  - TASK-001, TASK-002
- Related:
  - TASK-004: Will implement RestaurantTheme details
  - TASK-015: Will use these configs to build restaurant home pages

## Definition of Done

### Task Type: CODE/FILE WRITING TASK

**User Stories**:
1. **As a developer**, I want output config models so I can generate website configurations
2. **As a front-end developer**, I want JSON configs that are well-structured and validated
3. **As a developer**, I want configs that serialize cleanly to JSON for consumption

**Automated Tests**:
- [ ] Unit tests exist: `tests/test_configs_base.py`
- [ ] Unit tests exist: `tests/test_configs_pages.py`
- [ ] Serialization tests exist: `tests/test_configs_serialization.py`
- [ ] All tests pass: `pytest tests/test_configs*.py` exits with code 0
- [ ] Tests verify configs serialize to JSON cleanly
- [ ] Tests verify required fields are present (path, seo, at least one section)
- [ ] Test coverage >= 85%

**Code Quality**:
- [ ] All configs use Pydantic BaseModel
- [ ] Required fields are enforced
- [ ] Configs serialize to JSON correctly
- [ ] Code follows Python style guidelines

**Git & Version Control**:
- [ ] All files added to git
- [ ] Committed: `git commit -m "TASK-003: Define output contract models"`
- [ ] Pushed to origin
- [ ] Commit includes task ID

**Final Verification**:
- [ ] All checklist items completed
- [ ] All tests pass
- [ ] Configs can be serialized to JSON
- [ ] Code committed and pushed
