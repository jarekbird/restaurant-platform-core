# TASK-7.21: Hook events into existing components

**Section**: 7. Analytics & Event Instrumentation (Demo-Level)
**Subsection**: 7.21
**Task ID**: TASK-7.21

## Description

Add event calls from `lib/analytics/events.ts` to existing components: `app/preview/[slug]/page.tsx` (page view → `trackViewRestaurant`), `MenuItemCard` (add to cart → `trackAddToCart`), `CartDrawer` (start checkout, complete order), and loyalty capture components (`VipSignup*` → `trackJoinVip` / `trackSubmitEmailCapture`).

**Reference Implementation**: 
- `lib/analytics/events.ts` (from TASK-7.20)
- `app/preview/[slug]/page.tsx` (preview page)
- `components/menu/MenuItemCard.tsx` (menu item card)
- `components/order/CartDrawer.tsx` (cart drawer)

## Current State

Analytics event helper has been created in TASK-7.20, but events are not yet called from components.

**Important**: This task should be executed after TASK-7.20, and before TASK-8.22.

## Checklist

### Implementation Steps

- [ ] Step 1: Add page view event
  - [ ] In `app/preview/[slug]/page.tsx`, call `trackViewRestaurant(config)` on page load
- [ ] Step 2: Add menu category view event (optional)
  - [ ] In `MenuSectionList` or `MenuCategory`, call `trackViewMenuCategory(categoryName)` when category is viewed
- [ ] Step 3: Add add to cart event
  - [ ] In `MenuItemCard`, call `trackAddToCart(item)` when item is added to cart
- [ ] Step 4: Add checkout events
  - [ ] In `CartDrawer`, call `trackStartCheckout()` when checkout form is opened
  - [ ] In `CartDrawer`, call `trackCompleteOrder(order)` when order is placed
- [ ] Step 5: Add capture events
  - [ ] In `VipSignupBanner` and `VipSignupSection`, call `trackJoinVip()` or `trackSubmitEmailCapture()` on form submit

### Testing

- [ ] Write component tests:
  - [ ] Test that page view event is called on preview page load
  - [ ] Test that add to cart event is called when item is added
  - [ ] Test that checkout events are called in CartDrawer
  - [ ] Test that capture events are called in VipSignup components
  - [ ] Use spies/mocks on analytics helpers
- [ ] Run full test suite: `npm test`

## Related Tasks

- Previous: TASK-7.20
- Next: TASK-8.22
- Dependencies: TASK-7.20

## Definition of Done

This is a **CODE/FILE WRITING TASK**.

**Definition of Done**: "Analytics events have been hooked into preview page, MenuItemCard, CartDrawer, and VipSignup components. Component tests verify events fire on user interactions using spies/mocks. All tests pass. Code is committed and pushed to origin."

**User Stories**:
- As a developer, I want analytics events on key interactions so I can track user behavior
- As a restaurant owner, I want to see which menu items are popular so I can optimize my menu

**Automated Tests**: 
- Component tests using spies/mocks on analytics helpers verifying events fire on interactions
- Tests for page view, add to cart, checkout, and capture events

**Git Commit & Push**: 
- Commit with message: `feat(phase-3): hook analytics events into components (TASK-7.21)`
- Push to origin: `git push origin <branch-name>`
