# TASK-019: Build Promo & Campaign Page Configs

**Section**: 5. Page Configuration Builders
**Subsection**: 5.5
**Task ID**: TASK-019

## Description

Implement page configuration builder for promotional and campaign pages. These pages showcase special offers, discounts, sweepstakes, or limited-time campaigns with focused content and strong CTAs linking back into the ordering flow.

**Reference Implementation**: 
- `menuhq/restaurant-finder/plan/phase-3/master-plan.md` (Section 5.1)

## Current State

- PromoPageConfig model exists (from TASK-003)
- URL builders exist (from TASK-007)
- SEO metadata generator exists (from TASK-009)
- No promo page builder exists
- Need Campaign data model

**Prerequisites**: TASK-003, TASK-007, TASK-009 must be completed

## Checklist

### Preparation and Setup

- [ ] Review master plan Section 5.1 for promo page requirements
- [ ] Review PromoPageConfig model from TASK-003
- [ ] Plan Campaign data model
- [ ] Understand promo page structure

### Implementation Steps

- [ ] Step 1: Define Campaign data model
  - [ ] Create `Campaign` model with:
    - [ ] `name: str` (required)
    - [ ] `slug: str` (required)
    - [ ] `description: str` (required)
    - [ ] `start_date: Optional[datetime]`
    - [ ] `end_date: Optional[datetime]`
    - [ ] `hero_image_url: Optional[str]`
    - [ ] `offer_details: str` (required) - discount, offer description
    - [ ] `cta_text: str` (default "Order Now")
    - [ ] `cta_url: str` (required) - ordering URL
- [ ] Step 2: Implement promo page builder
  - [ ] Add `build_promo_page_config(restaurant: Restaurant, campaign: Campaign, theme: Optional[RestaurantTheme] = None) -> PromoPageConfig` function
  - [ ] Auto-select theme if not provided
- [ ] Step 3: Build promo page path and SEO
  - [ ] Use URL builder: `promo_path(restaurant, campaign.slug)`
  - [ ] Verify path follows `/restaurants/{city}/{slug}/promos/{campaign_slug}` pattern
  - [ ] Use SEO generator: `build_seo_metadata("promo", restaurant, campaign=campaign)`
- [ ] Step 4: Build promo hero section
  - [ ] Create hero with:
    - [ ] Headline: Campaign name or offer headline
    - [ ] Subheadline: Offer details
    - [ ] Image: Campaign hero image or restaurant image
    - [ ] Primary CTA: Strong CTA linking to ordering flow
    - [ ] CTA text: campaign.cta_text or "Order Now"
    - [ ] CTA URL: campaign.cta_url
- [ ] Step 5: Build promo content sections
  - [ ] Campaign Details section:
    - [ ] Full offer description
    - [ ] Terms and conditions (if applicable)
    - [ ] Start/end dates (if applicable)
  - [ ] How to Redeem section:
    - [ ] Instructions for claiming offer
    - [ ] Link to ordering flow
- [ ] Step 6: Ensure strong CTA presence
  - [ ] Primary CTA in hero (required)
  - [ ] Secondary CTA in content sections
  - [ ] All CTAs link back into ordering flow
- [ ] Step 7: Build JSON-LD schemas
  - [ ] Restaurant schema
  - [ ] Breadcrumb schema
  - [ ] Promo-specific schema (if applicable)

### Specific Requirements

- [ ] Requirement 1: Promo page paths follow pattern
  - [ ] Path: `/restaurants/{city}/{slug}/promos/{campaign_slug}`
  - [ ] Uses URL builder correctly
- [ ] Requirement 2: Strong CTA links to ordering
  - [ ] Primary CTA is prominent
  - [ ] CTA links back into ordering flow
  - [ ] CTA text is action-oriented

### Error Handling and Edge Cases

- [ ] Handle error case 1: Campaign with no CTA URL
  - [ ] Use default ordering URL from restaurant
- [ ] Handle error case 2: Campaign with no hero image
  - [ ] Use restaurant hero image or logo
- [ ] Handle edge case 1: Expired campaign
  - [ ] Show "Campaign ended" message or redirect
- [ ] Handle edge case 2: Future campaign
  - [ ] Show "Coming soon" or start date

### Testing

- [ ] Write unit tests: `tests/test_builders_pages_promo.py`
  - [ ] Test `build_promo_page_config()` with sample campaign
  - [ ] Test promo page paths follow `/restaurants/{city}/{slug}/promos/{campaign_slug}` pattern
  - [ ] Test strong CTA is present and links to ordering flow
  - [ ] Test config has valid path
  - [ ] Test config includes SEO metadata
  - [ ] Test hero section includes campaign details
  - [ ] Test campaign with no hero image
  - [ ] Test campaign with no CTA URL (uses default)
- [ ] Run full test suite: `pytest tests/test_builders_pages_promo.py`
- [ ] Verify test coverage: `pytest --cov=restaurant_site_planner.builders.pages`

### Documentation

- [ ] Add docstrings to builder function
- [ ] Document Campaign model
- [ ] Add examples of generated configs

### Verification

- [ ] Verify promo page paths are correct
- [ ] Verify CTAs link to ordering
- [ ] Verify no regressions

## Notes

- This task is part of Phase 3: Owner.com-Aligned Restaurant Sites
- **Execution Timing**: After TASK-018
- **Dependencies**: 
  - TASK-003: PromoPageConfig model
  - TASK-007: URL builders
  - TASK-009: SEO metadata generator
- **Important Considerations**: 
  - Promo pages should convert well
  - CTAs must be prominent
  - Paths must follow Owner.com patterns
- **Task Independence**: Can be developed after dependencies

## Related Tasks

- Previous: TASK-018 (Index page configs)
- Next: TASK-020 (Community & news configs)
- Dependencies:
  - TASK-003, TASK-007, TASK-009
- Related:
  - TASK-022: Will integrate with ordering flow

## Definition of Done

### Task Type: CODE/FILE WRITING TASK

**User Stories**:
1. **As a restaurant owner**, I want promo pages so I can run special offers and campaigns
2. **As a marketer**, I want focused campaign pages so promotions convert well
3. **As a customer**, I want clear promo pages so I can easily claim offers

**Automated Tests**:
- [ ] Unit tests exist: `tests/test_builders_pages_promo.py`
- [ ] All tests pass: `pytest tests/test_builders_pages_promo.py` exits with code 0
- [ ] Tests verify promo page paths follow `/restaurants/{city}/{slug}/promos/{campaign_slug}` pattern
- [ ] Tests verify strong CTA is present and links to ordering flow
- [ ] Test coverage >= 85%

**Code Quality**:
- [ ] Function has type hints
- [ ] Campaign model is properly defined
- [ ] Code follows Python style guidelines

**Git & Version Control**:
- [ ] All new files are added to git: `git add .`
- [ ] Changes are committed: `git commit -m "TASK-019: Build promo & campaign page configs"`
- [ ] Code is pushed to origin: `git push origin <branch-name>`
- [ ] Commit message includes task ID: TASK-019

**Final Verification**:
- [ ] All checklist items completed
- [ ] All tests pass
- [ ] Promo pages are complete
- [ ] Code committed and pushed
