# TASK-002.2: Implement Restaurant Model

**Section**: 0. Project Scaffolding & Foundations
**Subsection**: 0.2.2
**Task ID**: TASK-002.2
**Parent Task**: TASK-002

## Description

Implement the `Restaurant` Pydantic model that represents restaurant data. This model includes all fields needed for restaurant information: name, location, contact info, hours, ratings, photos, social profiles, and third-party links.

This is a core domain model that will be used throughout the site planner.

**Reference Implementation**: 
- `menuhq/restaurant-finder/ingestion/src/schemas/bulk-discovery.ts`
- `menuhq/restaurant-finder/ingestion/data/restaurants/*/metadata.discovery.json`

## Current State

- Models module structure exists (from TASK-002.1)
- Pydantic is installed (from TASK-002.1)
- No Restaurant model exists

**Prerequisites**: TASK-002.1 must be completed

## Checklist

### Preparation and Setup

- [ ] Review TypeScript schemas in `ingestion/src/schemas/bulk-discovery.ts`
- [ ] Examine sample JSON files to understand actual data format
- [ ] Review Pydantic model patterns
- [ ] Plan field structure and validation

### Implementation Steps

- [ ] Step 1: Create helper models
  - [ ] Define `Coordinates` class in `models/restaurant.py`:
    - [ ] `latitude: float` (required)
    - [ ] `longitude: float` (required)
  - [ ] Define `Photo` class:
    - [ ] `url: str` (required)
    - [ ] `source: Optional[str]`
    - [ ] `width: Optional[int]`
    - [ ] `height: Optional[int]`
- [ ] Step 2: Implement Restaurant model
  - [ ] Create `Restaurant` class in `models/restaurant.py`
  - [ ] Add required fields:
    - [ ] `name: str` (required)
    - [ ] `slug: str` (required)
    - [ ] `city: str` (required)
  - [ ] Add optional location fields:
    - [ ] `cuisine: Optional[str]`
    - [ ] `cuisines: Optional[List[str]]`
    - [ ] `neighborhood: Optional[str]`
    - [ ] `state: Optional[str]`
    - [ ] `address: Optional[str]`
    - [ ] `coordinates: Optional[Coordinates]`
  - [ ] Add optional contact fields:
    - [ ] `phone: Optional[str]`
    - [ ] `phone_display: Optional[str]`
    - [ ] `email: Optional[str]`
    - [ ] `website: Optional[str]`
  - [ ] Add optional business info:
    - [ ] `hours: Optional[Dict[str, str]]`
    - [ ] `price_range: Optional[str]`
    - [ ] `rating: Optional[float]`
    - [ ] `review_count: Optional[int]`
  - [ ] Add optional media fields:
    - [ ] `photos: Optional[List[Photo]]`
    - [ ] `hero_image_url: Optional[str]`
    - [ ] `logo_url: Optional[str]`
  - [ ] Add optional social/links:
    - [ ] `social_profiles: Optional[Dict[str, str]]`
    - [ ] `third_party_links: Optional[Dict[str, str]]`
- [ ] Step 3: Add validators
  - [ ] Add slug format validator (lowercase, alphanumeric, hyphens)
  - [ ] Add rating range validator (0-5)
  - [ ] Add phone format validator (optional)
  - [ ] Add URL validators for website, photos, social profiles
- [ ] Step 4: Export model
  - [ ] Add `Restaurant` to `models/__init__.py`
  - [ ] Export `Coordinates` and `Photo` if needed

### Specific Requirements

- [ ] Requirement 1: Model aligns with ingestion data
  - [ ] Fields match TypeScript schema
  - [ ] Can parse sample JSON files
- [ ] Requirement 2: Validation is comprehensive
  - [ ] Required fields are enforced
  - [ ] Optional fields are properly typed
  - [ ] Validators catch invalid data

### Error Handling and Edge Cases

- [ ] Handle error case 1: Missing required fields
  - [ ] Clear validation errors
- [ ] Handle error case 2: Invalid field values
  - [ ] Validators provide clear messages
- [ ] Handle edge case 1: Empty optional lists/dicts
  - [ ] Use Optional types correctly
- [ ] Handle edge case 2: Invalid URLs
  - [ ] URL validators catch invalid formats

### Testing

- [ ] Write unit tests: `tests/test_models_restaurant.py`
  - [ ] Test Restaurant creation with required fields
  - [ ] Test Restaurant creation with all fields
  - [ ] Test slug format validation
  - [ ] Test rating range validation (0-5)
  - [ ] Test URL validation
  - [ ] Test parsing from sample JSON
  - [ ] Test validation errors for missing required fields
  - [ ] Test validation errors for invalid values
- [ ] Run full test suite: `pytest tests/test_models_restaurant.py`
- [ ] Verify test coverage: `pytest --cov=restaurant_site_planner.models.restaurant`

### Documentation

- [ ] Add docstrings to Restaurant class
- [ ] Document field meanings
- [ ] Add examples of Restaurant creation

### Verification

- [ ] Verify model can parse sample JSON
- [ ] Verify validation works correctly
- [ ] Verify no regressions

## Notes

- This task is part of Phase 3: Owner.com-Aligned Restaurant Sites
- **Execution Timing**: After TASK-002.1
- **Dependencies**: 
  - TASK-002.1: Models module and Pydantic must exist
- **Important Considerations**: 
  - Model should closely match ingestion schema
  - Validation should be helpful, not overly strict
- **Task Independence**: Can be developed after TASK-002.1

## Related Tasks

- Parent: TASK-002 (Define core domain models)
- Previous: TASK-002.1 (Install Pydantic and set up models)
- Next: TASK-002.3 (Implement Location model)
- Dependencies:
  - TASK-002.1

## Definition of Done

### Task Type: CODE/FILE WRITING TASK

**User Stories**:
1. **As a developer**, I want a Restaurant model so I can work with restaurant data
2. **As a developer**, I want validation so invalid data is caught early

**Automated Tests**:
- [ ] Unit tests exist: `tests/test_models_restaurant.py`
- [ ] All tests pass: `pytest tests/test_models_restaurant.py` exits with code 0
- [ ] Tests verify successful parsing of realistic sample JSON payloads
- [ ] Tests verify validation errors when required fields are missing/invalid
- [ ] Test coverage >= 85%

**Code Quality**:
- [ ] Model has type hints
- [ ] Validators are comprehensive
- [ ] Code follows Python style guidelines

**Git & Version Control**:
- [ ] All new files are added to git: `git add .`
- [ ] Changes are committed: `git commit -m "TASK-002.2: Implement Restaurant model"`
- [ ] Code is pushed to origin: `git push origin <branch-name>`
- [ ] Commit message includes task ID: TASK-002.2

**Final Verification**:
- [ ] All checklist items completed
- [ ] All tests pass
- [ ] Model works correctly
- [ ] Code committed and pushed

