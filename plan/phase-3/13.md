# TASK-013: Implement FAQPage and BreadcrumbList Schema Generators

**Section**: 4. Structured Data (Schema.org)
**Subsection**: 4.2
**Task ID**: TASK-013

## Description

Implement generators for FAQPage and BreadcrumbList JSON-LD schemas. These support SEO and AI search by making FAQs and navigation breadcrumbs machine-readable.

FAQPage schema helps search engines and AI assistants understand common questions and answers. BreadcrumbList schema helps with navigation and search result display.

**Reference Implementation**: 
- `menuhq/restaurant-finder/plan/phase-3/master-plan.md` (Section 4.4)
- Schema.org FAQPage and BreadcrumbList documentation

## Current State

- Restaurant schema generator exists (from TASK-012)
- No FAQ or Breadcrumb schema generators exist
- Need QuestionAnswer and Breadcrumb data models

**Prerequisites**: TASK-012 must be completed

## Checklist

### Preparation and Setup

- [ ] Review master plan Section 4.4 for FAQ and Breadcrumb requirements
- [ ] Review Schema.org FAQPage and BreadcrumbList documentation
- [ ] Understand FAQ and Breadcrumb data structures
- [ ] Plan QuestionAnswer and Breadcrumb models

### Implementation Steps

- [ ] Step 1: Create FAQ and Breadcrumb data models
  - [ ] Create `src/restaurant_site_planner/models/faq.py`
  - [ ] Define `QuestionAnswer` model with:
    - [ ] `question: str` (required)
    - [ ] `answer: str` (required)
  - [ ] Create `src/restaurant_site_planner/models/breadcrumb.py`
  - [ ] Define `Breadcrumb` model with:
    - [ ] `label: str` (required)
    - [ ] `url: str` (required)
    - [ ] `position: int` (required) - order in breadcrumb chain
- [ ] Step 2: Implement FAQPage schema generator
  - [ ] Add `build_faq_schema(faq_items: List[QuestionAnswer]) -> dict` function
  - [ ] Create FAQPage schema structure:
    - [ ] `@context: "https://schema.org"`
    - [ ] `@type: "FAQPage"`
    - [ ] `mainEntity`: Array of Question objects, each with:
      - [ ] `@type: "Question"`
      - [ ] `name`: question text
      - [ ] `acceptedAnswer`: Object with:
        - [ ] `@type: "Answer"`
        - [ ] `text`: answer text
  - [ ] Handle empty FAQ list (return None or empty schema)
- [ ] Step 3: Implement BreadcrumbList schema generator
  - [ ] Add `build_breadcrumb_schema(crumbs: List[Breadcrumb]) -> dict` function
  - [ ] Create BreadcrumbList schema structure:
    - [ ] `@context: "https://schema.org"`
    - [ ] `@type: "BreadcrumbList"`
    - [ ] `itemListElement`: Array of ListItem objects, each with:
      - [ ] `@type: "ListItem"`
      - [ ] `position`: breadcrumb.position
      - [ ] `name`: breadcrumb.label
      - [ ] `item`: breadcrumb.url
  - [ ] Ensure positions are sequential (1, 2, 3, ...)
  - [ ] Handle empty breadcrumb list (return None or empty schema)
- [ ] Step 4: Add validation
  - [ ] Validate FAQ items have both question and answer
  - [ ] Validate breadcrumbs have sequential positions
  - [ ] Validate breadcrumb URLs are valid

### Specific Requirements

- [ ] Requirement 1: FAQ schema matches Schema.org patterns
  - [ ] Uses correct @type: "FAQPage"
  - [ ] Question/Answer structure is correct
  - [ ] All required fields present
- [ ] Requirement 2: Breadcrumb schema matches Schema.org patterns
  - [ ] Uses correct @type: "BreadcrumbList"
  - [ ] Positions are sequential and start at 1
  - [ ] All required fields present
- [ ] Requirement 3: Handles edge cases
  - [ ] Empty lists return None or valid empty schema
  - [ ] Missing data is handled gracefully

### Error Handling and Edge Cases

- [ ] Handle error case 1: Empty FAQ list
  - [ ] Return None or valid empty FAQPage schema
- [ ] Handle error case 2: Empty breadcrumb list
  - [ ] Return None or valid empty BreadcrumbList schema
- [ ] Handle error case 3: Invalid breadcrumb positions
  - [ ] Validate positions are sequential
  - [ ] Auto-correct positions if needed (or raise error)
- [ ] Handle edge case 1: FAQ item with empty question/answer
  - [ ] Skip invalid items or raise error
- [ ] Handle edge case 2: Breadcrumb with invalid URL
  - [ ] Validate URL format
  - [ ] Raise error or skip invalid items

### Testing

- [ ] Write unit tests: `tests/test_generators_schema_faq_breadcrumb.py`
  - [ ] Test `build_faq_schema()` with sample FAQs
  - [ ] Test JSON-LD structure matches Schema.org FAQPage patterns
  - [ ] Test question/answer are correctly structured
  - [ ] Test `build_faq_schema()` with empty list
  - [ ] Test `build_breadcrumb_schema()` with sample breadcrumbs
  - [ ] Test JSON-LD structure matches Schema.org BreadcrumbList patterns
  - [ ] Test breadcrumb chains (home → city → restaurant → menu) have correct position and URLs
  - [ ] Test positions are sequential
  - [ ] Test `build_breadcrumb_schema()` with empty list
  - [ ] Test validation errors for invalid data
- [ ] Run full test suite: `pytest tests/test_generators_schema_faq_breadcrumb.py`
- [ ] Verify test coverage: `pytest --cov=restaurant_site_planner.generators.schema`

### Documentation

- [ ] Add docstrings to FAQ and Breadcrumb schema generators
- [ ] Document Schema.org field mappings
- [ ] Add examples of generated schemas
- [ ] Document how to create FAQ and Breadcrumb data

### Verification

- [ ] Verify schemas are Schema.org compliant
- [ ] Verify FAQ structure is correct
- [ ] Verify Breadcrumb structure is correct
- [ ] Verify no regressions

## Notes

- This task is part of Phase 3: Owner.com-Aligned Restaurant Sites
- **Execution Timing**: After TASK-012
- **Dependencies**: 
  - TASK-012: Restaurant schema generator (for context)
- **Important Considerations**: 
  - FAQ and Breadcrumb schemas must be valid JSON-LD
  - Follow Schema.org specifications exactly
  - Breadcrumb positions must be sequential
- **Task Independence**: Can be developed after TASK-012

## Related Tasks

- Previous: TASK-012 (Restaurant schema)
- Next: TASK-014 (Local SEO schemas)
- Dependencies:
  - TASK-012
- Related:
  - TASK-015: Will use FAQ and Breadcrumb schemas in page configs

## Definition of Done

### Task Type: CODE/FILE WRITING TASK

**User Stories**:
1. **As an SEO specialist**, I want FAQ schemas so search engines can display FAQs in search results
2. **As a developer**, I want breadcrumb schemas so navigation is machine-readable
3. **As an AI assistant**, I want structured FAQs so I can answer questions accurately

**Automated Tests**:
- [ ] Unit tests exist: `tests/test_generators_schema_faq_breadcrumb.py`
- [ ] All tests pass: `pytest tests/test_generators_schema_faq_breadcrumb.py` exits with code 0
- [ ] Tests verify JSON-LD structure matches Schema.org patterns for sample FAQs
- [ ] Tests verify breadcrumb chains have correct position and URLs
- [ ] Test coverage >= 85%

**Code Quality**:
- [ ] Functions have type hints
- [ ] Schemas are Schema.org compliant
- [ ] Code follows Python style guidelines

**Git & Version Control**:
- [ ] All new files are added to git: `git add .`
- [ ] Changes are committed: `git commit -m "TASK-013: Implement FAQPage and BreadcrumbList schema generators"`
- [ ] Code is pushed to origin: `git push origin <branch-name>`
- [ ] Commit message includes task ID: TASK-013

**Final Verification**:
- [ ] All checklist items completed
- [ ] All tests pass
- [ ] Schemas are Schema.org compliant
- [ ] Code committed and pushed
