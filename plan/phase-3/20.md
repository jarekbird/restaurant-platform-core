# TASK-020: Build Community/Fundraising and News Post Configs

**Section**: 5. Page Configuration Builders
**Subsection**: 5.6
**Task ID**: TASK-020

## Description

Implement page configuration builders for community events, fundraising activities, and news/blog posts. These pages support restaurant content marketing and community engagement with clear titles, body content, dates, and relevant CTAs.

**Reference Implementation**: 
- `menuhq/restaurant-finder/plan/phase-3/master-plan.md` (Sections 5.2, 5.4)

## Current State

- NewsPostConfig model exists (from TASK-003)
- URL builders exist (from TASK-007)
- SEO metadata generator exists (from TASK-009)
- No community/news page builders exist
- Need Event and NewsPost data models

**Prerequisites**: TASK-003, TASK-007, TASK-009 must be completed

## Checklist

### Preparation and Setup

- [ ] Review master plan Sections 5.2 and 5.4 for community/news requirements
- [ ] Review NewsPostConfig model from TASK-003
- [ ] Plan Event and NewsPost data models
- [ ] Understand content structure

### Implementation Steps

- [ ] Step 1: Define Event data model
  - [ ] Create `CommunityEvent` model with:
    - [ ] `title: str` (required)
    - [ ] `slug: str` (required)
    - [ ] `description: str` (required)
    - [ ] `event_date: Optional[datetime]`
    - [ ] `start_time: Optional[str]`
    - [ ] `end_time: Optional[str]`
    - [ ] `beneficiary: Optional[str]` - charity/organization
    - [ ] `hero_image_url: Optional[str]`
    - [ ] `cta_text: str` (default "Learn More" or "Order Online During Event")
    - [ ] `cta_url: Optional[str]` - ordering or event URL
- [ ] Step 2: Define NewsPost data model
  - [ ] Create `NewsPost` model with:
    - [ ] `title: str` (required)
    - [ ] `slug: str` (required)
    - [ ] `body: str` (required) - markdown or HTML content
    - [ ] `published_date: datetime` (required)
    - [ ] `hero_image_url: Optional[str]`
    - [ ] `tags: List[str]` - e.g. ["events", "menu-updates"]
    - [ ] `author: Optional[str]`
- [ ] Step 3: Implement community event builder
  - [ ] Add `build_community_event_config(restaurant: Restaurant, event: CommunityEvent, theme: Optional[RestaurantTheme] = None) -> PageConfig` function
  - [ ] Auto-select theme if not provided
- [ ] Step 4: Build event page path and SEO
  - [ ] Use URL builder for event path (e.g. `/restaurants/{city}/{slug}/events/{event_slug}`)
  - [ ] Use SEO generator: `build_seo_metadata("event", restaurant, event=event)`
- [ ] Step 5: Build event content sections
  - [ ] Hero section:
    - [ ] Headline: Event title
    - [ ] Subheadline: Event date/time
    - [ ] Image: Event hero image
    - [ ] CTA: Event CTA
  - [ ] Event Details section:
    - [ ] Full description
    - [ ] Date and time
    - [ ] Beneficiary information (if applicable)
    - [ ] How to participate
  - [ ] CTA section:
    - [ ] Primary CTA (order online, RSVP, etc.)
- [ ] Step 6: Implement news post builder
  - [ ] Add `build_news_post_config(restaurant: Restaurant, post: NewsPost, theme: Optional[RestaurantTheme] = None) -> NewsPostConfig` function
  - [ ] Auto-select theme if not provided
- [ ] Step 7: Build news post path and SEO
  - [ ] Use URL builder: `news_post_path(restaurant, post.slug)`
  - [ ] Verify path follows `/restaurants/{city}/{slug}/news/{slug}` pattern
  - [ ] Use SEO generator: `build_seo_metadata("news", restaurant, post=post)`
- [ ] Step 8: Build news post content sections
  - [ ] Hero section:
    - [ ] Headline: Post title
    - [ ] Published date
    - [ ] Image: Post hero image
  - [ ] Content section:
    - [ ] Body content (markdown/HTML)
    - [ ] Tags (if applicable)
    - [ ] Author (if applicable)
  - [ ] Related content section (optional):
    - [ ] Links to related posts
- [ ] Step 9: Build JSON-LD schemas
  - [ ] Restaurant schema
  - [ ] Breadcrumb schema
  - [ ] Event schema (if applicable - Schema.org Event)
  - [ ] Article schema for news posts (Schema.org Article)

### Specific Requirements

- [ ] Requirement 1: Configs include clear title, body, date/time
  - [ ] Titles are descriptive
  - [ ] Body content is well-formatted
  - [ ] Dates are formatted correctly
- [ ] Requirement 2: Relevant CTAs are present
  - [ ] Event CTAs link to ordering or event page
  - [ ] News posts may have CTAs if relevant
- [ ] Requirement 3: SEO metadata and schema are included
  - [ ] SEO metadata is complete
  - [ ] Schema is appropriate (Event, Article)

### Error Handling and Edge Cases

- [ ] Handle error case 1: Event with no date
  - [ ] Show "Date TBD" or omit date
- [ ] Handle error case 2: News post with no body
  - [ ] Require body or raise error
- [ ] Handle edge case 1: Past events
  - [ ] Show "Past Event" indicator
- [ ] Handle edge case 2: Future events
  - [ ] Show "Upcoming Event" indicator

### Testing

- [ ] Write unit tests: `tests/test_builders_pages_community.py`
  - [ ] Test `build_community_event_config()` with sample event
  - [ ] Test `build_news_post_config()` with sample post
  - [ ] Test configs include clear title, body, date/time, and relevant CTAs
  - [ ] Test configs include SEO metadata and schema where appropriate
  - [ ] Test event with no date
  - [ ] Test news post path follows pattern
  - [ ] Test configs have valid paths
- [ ] Run full test suite: `pytest tests/test_builders_pages_community.py`
- [ ] Verify test coverage: `pytest --cov=restaurant_site_planner.builders.pages`

### Documentation

- [ ] Add docstrings to builder functions
- [ ] Document Event and NewsPost models
- [ ] Add examples of generated configs

### Verification

- [ ] Verify event and news configs are complete
- [ ] Verify CTAs are relevant
- [ ] Verify no regressions

## Notes

- This task is part of Phase 3: Owner.com-Aligned Restaurant Sites
- **Execution Timing**: After TASK-019
- **Dependencies**: 
  - TASK-003: NewsPostConfig model
  - TASK-007: URL builders
  - TASK-009: SEO metadata generator
- **Important Considerations**: 
  - Community content supports SEO and engagement
  - Events should drive ordering during event dates
  - News posts should answer real queries
- **Task Independence**: Can be developed after dependencies

## Related Tasks

- Previous: TASK-019 (Promo page configs)
- Next: TASK-021 (Ordering & loyalty models)
- Dependencies:
  - TASK-003, TASK-007, TASK-009
- Related:
  - TASK-022: Will integrate CTAs with ordering

## Definition of Done

### Task Type: CODE/FILE WRITING TASK

**User Stories**:
1. **As a restaurant owner**, I want community event pages so I can promote fundraisers and events
2. **As a content marketer**, I want news post pages so I can share updates and stories
3. **As a customer**, I want event information so I can participate in community activities

**Automated Tests**:
- [ ] Unit tests exist: `tests/test_builders_pages_community.py`
- [ ] All tests pass: `pytest tests/test_builders_pages_community.py` exits with code 0
- [ ] Tests verify configs include clear title, body, date/time, and relevant CTAs
- [ ] Tests verify configs include SEO metadata and schema where appropriate
- [ ] Test coverage >= 85%

**Code Quality**:
- [ ] Functions have type hints
- [ ] Event and NewsPost models are properly defined
- [ ] Code follows Python style guidelines

**Git & Version Control**:
- [ ] All new files are added to git: `git add .`
- [ ] Changes are committed: `git commit -m "TASK-020: Build community/fundraising and news post configs"`
- [ ] Code is pushed to origin: `git push origin <branch-name>`
- [ ] Commit message includes task ID: TASK-020

**Final Verification**:
- [ ] All checklist items completed
- [ ] All tests pass
- [ ] Event and news configs are complete
- [ ] Code committed and pushed
